<script>
    // Log the visit and THEN redirect
    (function() {
        const visitData = {
            timestamp: new Date().toISOString(),
            referrer: document.referrer || 'direct',
            userAgent: navigator.userAgent,
            location: window.location.href
        };
        
        // Send to Google Apps Script and wait for it
        fetch('https://script.google.com/macros/s/AKfycbwaHTzJ8F30wWQoxmdaxU29Z713GIERNGS7SaU-SxF6G_eojEht_HNheBiPVJf3Kvvh/exec', {
            method: 'POST',
            mode: 'no-cors',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(visitData)
        })
        .then(() => {
            // Redirect after tracking completes
            window.location.replace('/home');
        })
        .catch(() => {
            // Redirect even if tracking fails
            window.location.replace('/home');
        });
        
        // Failsafe: redirect after 500ms even if fetch hangs
        setTimeout(function() {
            window.location.replace('/home');
        }, 500);
    })();
</script>
