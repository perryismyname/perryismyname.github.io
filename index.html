<script>
    // Log the visit and THEN redirect
    (function() {
        const visitData = {
            timestamp: new Date().toLocaleString('en-US', { 
                timeZone: 'America/Los_Angeles',
                year: 'numeric',
                month: '2-digit', 
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            }),
            referrer: document.referrer || 'direct',
            userAgent: navigator.userAgent
        };
        
        // Send to Google Apps Script and wait for it
        fetch('https://script.google.com/macros/s/AKfycbwaHTzJ8F30wWQoxmdaxU29Z713GIERNGS7SaU-SxF6G_eojEht_HNheBiPVJf3Kvvh/exec', {
            method: 'POST',
            mode: 'no-cors',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(visitData)
        })
        .then(() => {
            window.location.replace('/home');
        })
        .catch(() => {
            window.location.replace('/home');
        });
        
        // Failsafe: redirect after 500ms even if fetch hangs
        setTimeout(function() {
            window.location.replace('/home');
        }, 500);
    })();
</script>
